## TODO

- [x] 将资源移入out文件夹中
- [ ] java使用java编写程序解析
- [ ] 标准化各种类型处理输出
- [ ] 灰条消息的文本
- [ ] 加入群聊-1012分析extStr
- [x] 找到判断nudgeaction的更准确方法
- [x] 完成nudgeaction的解析
- [x] 简略分析撤回消息不明字符串结构
- [ ] 解析修改群名的方法
- [ ] 打卡信息html解析



## 类型

| type(t)        | 说明           | 对应类型ID  |
| -------------- | -------------- | ----------- |
| msg            | 文本类型       | -1000,-1051 |
| mixmsg         | 图文混排       | -1035       |
| img            | 图片类型       | -2000       |
| revoke         | 撤回消息       | -5040       |
|                |                |             |
| jointroop      | 加群提示       | -1012       |
| troopcallstart | 群语音通话发起 | -2016       |
| troopcallend   | 群语音通话结束 | -4008       |
|                |                |             |



## 总的

每一条消息结构如下

```json
{"t":"类型", "c":"内容", "e":"状态码", "s":"发送者", "i":"发送的时间戳"}
```



### msg mixmsg文本类型

内容部分（"c"部分）看起来是这样

```json
[
    {'t': 'm', 'c': {'m': '真是离蒲'}, 'e': {'code': 1}},
 	{'t': 'qqemoji', 'c': {'path': 'output/emoticon1/new/s5.png', 'index': '5'}, 'e': {'code': 1}},
    {'t': 'm', 'c': {'m': '绝了'}, 'e': {'code': 1}}
]
```

其中可能有三种元素，元素的格式为：

```json
{"t":"类型", "c":"内容", e:"状态码"}
```



| m    | 文本     |
| ---- | -------- |
| m    | 文本内容 |

| qqemoji | qq小表情                 |
| ------- | ------------------------ |
| path    | 路径（已经拷贝到output） |
| index   | 表情id                   |

注：该表情是指腾讯的表情，若有emoji则需要字体支持，较为麻烦

| img       | 图片（同下）                 |
| --------- | ---------------------------- |
| imgPath   | 文件路径（已经拷贝到output） |
| imgType   | 图片类型，字符串             |
| name      | 新的图片名                   |
| imgWidth  | 图片宽度                     |
| imgHeight | 图片高度                     |

### img  图片类型

| 键        | 值                           |
| --------- | ---------------------------- |
| imgPath   | 文件路径（已经拷贝到output） |
| imgType   | 图片类型，字符串             |
| name      | 新的图片名                   |
| imgWidth  | 图片宽度                     |
| imgHeight | 图片高度                     |

### revoke  撤回消息

| 键   | 值             |
| ---- | -------------- |
| text | 文本内容       |
| type | bySelf/byAdmin |

### 

### tip  灰条提示信息

| 键   | 值                                                   |
| ---- | ---------------------------------------------------- |
| text | 文本内容，xxx发起了语音通话                          |
| type | jointroop, invite, qbotjointroop, newfriend, unknown |
| ext  | 额外信息                                             |

额外信息内容：

#### jointroop  加入群聊

| 额外信息键 | 值   |
| ---------- | ---- |
| newmember  | qq号 |

#### invite  邀请进群

| 额外信息键 | 值   |
| ---------- | ---- |
| invitorUin | qq号 |
| inviteeUin | qq号 |

#### qbotjointroop  邀请q群管家进群

| 额外信息键 | 值                            |
| ---------- | ----------------------------- |
| invitorUin | qq号                          |
| inviteeUin | qq号，一般也就是Q群管家自己了 |

#### newfriend 你已经和xxx成为好友

你已经和xxx成为好友，现在可以开始聊天了。

无额外信息

### call  语音通话

| 键   | 值                           |
| ---- | ---------------------------- |
| text | 文本内容，xxx发起了语音通话  |
| type | troopcallstart，troopcallend |

### file 文件

| 键       | 值                               |
| -------- | -------------------------------- |
| received | Bool，是否已经接收               |
| fileName | 文件名称                         |
| filePath | 已被接收的文件路径（若已被接收） |
| fileSize | 文件大小（若已被接收）           |

### marketface 大表情

| 键      | 值           |
| ------- | ------------ |
| text    | 文本内容     |
| name    | 表情中文名称 |
| imgType | "marketface" |
